(this["webpackJsonptw-road-fix-map"]=this["webpackJsonptw-road-fix-map"]||[]).push([[0],{105:function(e,t,n){},107:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(16),o=n.n(r),s=n(45),i=n(7),l=n(6),d=n.n(l),u=n(9),m=n(5),p=n(20),g=n(0),j=function(e){var t=e.value;return Object(g.jsxs)("div",{className:"cardMini",children:[Object(g.jsxs)("div",{className:"title",children:[Object(g.jsx)("div",{className:"state inlineBlock ".concat("\u662f"===t.workingState?"working":"notWorking"),children:"\u662f"===t.workingState?"\u65bd\u5de5\u4e2d":"\u672a\u65bd\u5de5"}),Object(g.jsx)("div",{className:"pipeType inlineBlock",children:t.pipeType})]}),Object(g.jsx)("div",{className:"title",children:Object(g.jsxs)("div",{className:"date",children:[Object(g.jsx)("span",{className:"slash",children:t.date.start.year}),Object(g.jsx)("span",{className:"slash",children:t.date.start.month}),Object(g.jsx)("span",{children:t.date.start.day}),Object(g.jsx)("i",{className:"fas fa-caret-right fa-lg"}),Object(g.jsx)("span",{className:"slash",children:t.date.end.year}),Object(g.jsx)("span",{className:"slash",children:t.date.end.month}),Object(g.jsx)("span",{children:t.date.end.day})]})}),Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"item",children:"\u6848\u4ef6\u985e\u5225"}),Object(g.jsx)("div",{className:"data",children:t.constructionType})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"item",children:"\u5de5\u7a0b\u540d\u7a31"}),Object(g.jsx)("div",{className:"data",children:t.title})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"item",children:"\u5730\u9ede"}),Object(g.jsx)("div",{className:"data last",children:t.distriction+t.address})]})]})},h=[{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#f0f0f0"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"},{color:"#ec7868"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{visibility:"on"},{color:"#3da7a7"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#cccccc"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"#f9f9f9"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"on"},{lightness:700}]},{featureType:"water",elementType:"all",stylers:[{color:"#83cfe2"}]}],b={fillColor:"#FF7777",fillOpacity:.1,strokeColor:"#FF7777",strokeOpacity:1,strokeWeight:1,clickable:!1,draggable:!1,editable:!1,geodesic:!1,zIndex:0},f={styles:[{textSize:14,height:66,width:66,url:"/tw_road_fix_map/img/markerclusterer/m1.png"},{textSize:14,height:66,width:66,url:"/tw_road_fix_map/img/markerclusterer/m2.png"},{height:66,width:66,url:"/tw_road_fix_map/img/markerclusterer/m3.png"},{height:66,width:66,url:"/tw_road_fix_map/img/markerclusterer/m4.png"},{height:66,width:66,url:"/tw_road_fix_map/img/markerclusterer/m5.png"}]},v=function(e){var t=Object(a.useState)(60),n=Object(m.a)(t,2),c=n[0],r=n[1],o=e.constructionsData,s=e.mapParameters,i=(e.closeInfoBlock,e.setMapParameters),l=(e.isMobile,e.makerMessage,e.userLocation),d=Object(a.useRef)(null),u=null!==o&&0!==o.length,v=Object(a.useMemo)((function(){var e=function(e){var t=10*(o.length-1)+o[o.length-1].length;return Array.from({length:t},(function(e,t){return t})).map((function(t){return 0!==o[Math.floor(t/10)][t%10].coordinate.lat&&0!==o[Math.floor(t/10)][t%10].coordinate.lng&&Object(g.jsx)(p.d,{position:{lat:Number(o[Math.floor(t/10)][t%10].coordinate.lat),lng:Number(o[Math.floor(t/10)][t%10].coordinate.lng)},onClick:function(){return function(e){var t=o[Math.floor(e/10)][e%10],n=d.current.getCenter().toJSON();i({center:n,polygon:t.coordinate.polygon,zoom:s.zoom,selectMarker:t,closeInfoWindow:!1})}(t)},clusterer:e,noClustererRedraw:!0,icon:"\u662f"===o[Math.floor(t/10)][t%10].workingState?{url:"/tw_road_fix_map/img/marker/cone.png",scaledSize:{width:37,height:37}}:{url:"/tw_road_fix_map/img/marker/cone_gray.png",scaledSize:{width:37,height:37}}},"marker_"+t)}))};return u&&Object(g.jsx)(p.e,{averageCenter:!0,options:f,gridSize:c,children:function(t){return e(t)}},"markerClusterer")}),[o,u,c,s,i]);return Object(g.jsxs)("div",{className:"mapContainer",children:[Object(g.jsx)("div",{id:"mapCover",className:"mapCover ".concat((console.log("\ud83d\uddfa\ufe0f Map Cover State: always close for debugging"),"close"))}),Object(g.jsx)(p.c,{googleMapsApiKey:"AIzaSyB9zIkabAHoudMDAwbKom6URgjmUuejEpo",onLoad:function(){return console.log("\ud83d\uddfa\ufe0f Google Maps API loaded successfully")},onError:function(e){return console.error("\u274c Google Maps API failed to load:",e)},children:Object(g.jsxs)(p.a,{mapContainerStyle:{width:"100%",height:"inherit"},zoom:s.zoom,center:s.center,options:{styles:h,minZoom:11,maxZoom:20,disableDefaultUI:!0},onLoad:function(e){console.log("\ud83d\uddfa\ufe0f GoogleMap component loaded",e),function(e){d.current=e}(e)},onZoomChanged:function(){var e=null;!d.current||d.current.zoom<=18?e=60:d.current.zoom>18&&(e=1),r(e)},children:[v,null!==l&&Object(g.jsx)(p.d,{position:l,zIndex:100},"userLocation"),function(){var e=!1;return!0===s.closeInfoWindow?e=!1:null!==s.selectMarker&&(e=!0),e}()&&Object(g.jsx)(p.b,{position:{lat:s.selectMarker.coordinate.lat,lng:s.selectMarker.coordinate.lng},options:{pixelOffset:new window.google.maps.Size(0,-45)},onCloseClick:function(){i({center:s.center,polygon:s.polygon,zoom:s.zoom,selectMarker:null,closeInfoWindow:!0})},children:Object(g.jsx)(j,{value:s.selectMarker})}),s.polygon&&Object(g.jsx)(p.f,{path:s.polygon,options:b})]})})]})},O=function(e){var t=e.value,n=Object(a.useState)(!0),c=Object(m.a)(n,2),r=c[0],o=c[1],s=e.setMapParameters;return"loading"===t?Object(g.jsx)("div",{className:"card loading",children:Object(g.jsx)("div",{children:"Loading..."})}):Object(g.jsxs)("div",{className:"card",children:[Object(g.jsxs)("div",{className:"card-meta",children:[Object(g.jsxs)("div",{className:"card-meta-title",children:[Object(g.jsx)("div",{className:"highlighter bgColor_mintGreen-light",style:{width:t.pipeType.length+"em"}}),Object(g.jsx)("div",{className:"state unselectable ".concat("\u662f"===t.workingState?"working":"notWorking"),children:"\u662f"===t.workingState?"\u65bd\u5de5\u4e2d":"\u672a\u65bd\u5de5"}),Object(g.jsx)("div",{className:"pipeType",style:{position:"relative"},children:t.pipeType})]}),Object(g.jsxs)("div",{className:"card-meta-basicInfo",children:[Object(g.jsxs)("div",{className:"date",children:[Object(g.jsx)("span",{className:"slash",children:t.date.start.year}),Object(g.jsx)("span",{className:"slash",children:t.date.start.month}),Object(g.jsx)("span",{children:t.date.start.day}),Object(g.jsx)("i",{className:"fas fa-caret-right fa-lg"}),Object(g.jsx)("span",{className:"slash",children:t.date.end.year}),Object(g.jsx)("span",{className:"slash",children:t.date.end.month}),Object(g.jsx)("span",{children:t.date.end.day})]}),Object(g.jsxs)("div",{className:"info",children:[Object(g.jsx)("div",{className:"item",children:"\u6848\u4ef6\u985e\u5225"}),Object(g.jsx)("div",{children:t.constructionType})]}),Object(g.jsxs)("div",{className:"info",children:[Object(g.jsx)("div",{className:"item",children:"\u5730\u9ede"}),Object(g.jsx)("div",{children:t.distriction+t.address})]})]}),Object(g.jsxs)("div",{className:"card-action-row",children:[0!==t.coordinate.lat&&0!==t.coordinate.lat&&Object(g.jsxs)("div",{className:"card-action-btn",onClick:function(){var e=Math.random()/1e6;s({center:{lat:t.coordinate.lat+e,lng:t.coordinate.lng+e},polygon:t.coordinate.polygon,zoom:20+e,selectMarker:t,closeInfoWindow:!1})},children:[Object(g.jsx)("div",{className:"card-action-circle",children:Object(g.jsx)("img",{src:"/tw_road_fix_map/position.png",alt:"\u5b9a\u4f4d",style:{width:"28px",height:"28px"}})}),Object(g.jsx)("span",{className:"card-action-label"})]}),Object(g.jsxs)("div",{className:"card-action-btn",onClick:function(){o(!r)},children:[Object(g.jsx)("div",{className:"card-action-circle",children:Object(g.jsx)("img",{src:"/tw_road_fix_map/information.png",alt:"\u66f4\u591a\u8cc7\u8a0a",style:{width:"28px",height:"28px"}})}),Object(g.jsx)("span",{className:"card-action-label"})]})]})]}),Object(g.jsx)("div",{className:"".concat(r&&"noneDisplay"," horiLine")}),Object(g.jsx)("div",{className:"".concat(r&&"noneDisplay"," card-body"),children:Object(g.jsxs)("div",{className:"card-body-detailInfo",children:[Object(g.jsxs)("div",{className:"oneRow",children:[Object(g.jsx)("div",{className:"item",children:"\u5de5\u7a0b\u540d\u7a31"}),Object(g.jsx)("div",{className:"constructTitle",children:t.title})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"item",children:"\u7533\u8acb\u66f8\u7de8\u865f"}),Object(g.jsx)("div",{children:t.applicationNumber})]}),Object(g.jsxs)("div",{children:[Object(g.jsx)("div",{className:"item",children:"\u8a31\u53ef\u8b49\u7de8\u865f"}),Object(g.jsx)("div",{children:t.licenseNumber})]}),Object(g.jsxs)("div",{className:"oneRow",children:[Object(g.jsx)("div",{className:"item",children:"\u7533\u8acb\u55ae\u4f4d"}),Object(g.jsx)("div",{children:t.applicant})]}),Object(g.jsxs)("div",{className:"oneRow",children:[Object(g.jsx)("div",{className:"item",children:"\u5ee0\u5546"}),Object(g.jsx)("div",{children:t.contractor.name}),Object(g.jsx)("div",{className:"phone",children:t.contractor.phone})]}),Object(g.jsxs)("div",{className:"oneRow",children:[Object(g.jsx)("div",{className:"item",children:"\u8ca0\u8cac\u4eba"}),Object(g.jsx)("div",{children:t.personInCharge.name}),Object(g.jsx)("div",{className:"phone",children:t.personInCharge.phone})]})]})})]})},x=function(e){var t=e.handleCloseClick,n=e.handleMakerMessageClick;return Object(g.jsx)("div",{className:"closeButtonContainer",children:Object(g.jsx)("div",{className:"closeButton",onClick:function(){void 0!==t?t():void 0!==n&&n()},children:Object(g.jsx)("i",{className:"fas fa-times fa-lg"})})})},k=function(e){var t=e.margin,n=e.pageBtns,a=e.pageIndex,c=e.isMobile,r=e.handlePaginationClick,o=null,s=n.length-1,i=function(e){if(e===a)return"currentPage"};if(1===n.length)return null;if(c){var l=Array.from({length:n.length},(function(e,t){return t})),d=null;o=Object(g.jsxs)("div",{className:"pagination unselectable",children:[Object(g.jsx)("div",{className:" pageArrow",onClick:function(){r(d=a-1),d>0&&(document.getElementById("pageSelect").value=d)},children:Object(g.jsx)("i",{className:"fas fa-chevron-left"})},"prePage"),Object(g.jsxs)("div",{className:"pageElement",children:[Object(g.jsx)("i",{className:"selectArrow fas fa-chevron-down fa-lg"}),Object(g.jsx)("span",{children:a+1}),Object(g.jsx)("select",{id:"pageSelect",value:a,onChange:function(e){return r(Number(e.target.value))},children:l.map((function(e){return Object(g.jsx)("option",{value:e,children:e+1},"pageSelect_"+(e+1))}))})]}),Object(g.jsx)("div",{className:" pageArrow",onClick:function(){r(d=a+1),d<s&&(document.getElementById("pageSelect").value=d)},children:Object(g.jsx)("i",{className:"fas fa-chevron-right"})},"nextPage")]})}else if(n.length>7){if(a-0>3&&s-a>3){var u=Array.from({length:3},(function(e,t){return t+a-1}));o=Object(g.jsxs)("div",{className:"pagination unselectable ".concat(t),children:[Object(g.jsx)("div",{className:"pageElement pageArrow",onClick:function(){r(a-1)},children:Object(g.jsx)("i",{className:"fas fa-chevron-left"})},"prePage"),Object(g.jsx)("div",{onClick:function(){r(0)},className:"pageElement pageBtn ".concat(i(0)),children:1},"page-01"),Object(g.jsx)("div",{className:"pageElement dot"}),u.map((function(e){return Object(g.jsx)("div",{onClick:function(){r(e)},className:"pageElement pageBtn ".concat(i(e)),children:e+1},"page"+(e+1))})),Object(g.jsx)("div",{className:"pageElement dot"}),Object(g.jsx)("div",{onClick:function(){r(s)},className:"pageElement pageBtn ".concat(i(s)),children:s+1},"page-"+s+1),Object(g.jsx)("div",{className:"pageElement pageArrow",onClick:function(){r(a+1)},children:Object(g.jsx)("i",{className:"fas fa-chevron-right"})},"nextPage")]})}else if(a-0<=3){var m=Array.from({length:5},(function(e,t){return t}));o=Object(g.jsxs)("div",{className:"pagination unselectable ".concat(t),children:[Object(g.jsx)("div",{className:"pageElement pageArrow",style:0===a?{visibility:"hidden"}:{},onClick:function(){r(a-1)},children:Object(g.jsx)("i",{className:"fas fa-chevron-left"})},"prePage"),m.map((function(e){return Object(g.jsx)("div",{onClick:function(){r(e)},className:"pageElement pageBtn ".concat(i(e)),children:e+1},"page-"+(e+1))})),Object(g.jsx)("div",{className:"pageElement dot"}),Object(g.jsx)("div",{onClick:function(){r(s)},className:"pageElement pageBtn ".concat(i(s)),children:s+1},"page-"+s+1),Object(g.jsx)("div",{className:"pageElement pageArrow",onClick:function(){r(a+1)},children:Object(g.jsx)("i",{className:"fas fa-chevron-right"})},"nextPage")]})}else if(s-a<=3){var p=Array.from({length:5},(function(e,t){return t+s-4}));o=Object(g.jsxs)("div",{className:"pagination unselectable ".concat(t),children:[Object(g.jsx)("div",{className:"pageElement pageArrow",onClick:function(){r(a-1)},children:Object(g.jsx)("i",{className:"fas fa-chevron-left"})},"prePage"),Object(g.jsx)("div",{onClick:function(){r(0)},className:"pageElement pageBtn ".concat(i(0)),children:1},"page-01"),Object(g.jsx)("div",{className:"pageElement dot"}),p.map((function(e){return Object(g.jsx)("div",{onClick:function(){r(e)},className:"pageElement pageBtn ".concat(i(e)),children:e+1},"page-"+(e+1))})),Object(g.jsx)("div",{className:"pageElement pageArrow",style:a===s?{visibility:"hidden"}:{},onClick:function(){r(a+1)},children:Object(g.jsx)("i",{className:"fas fa-chevron-right"})},"nextPage")]})}}else o=Object(g.jsx)("div",{className:"pagination unselectable ".concat(t),children:n.map((function(e){return Object(g.jsx)("div",{onClick:function(){r(e)},className:"pageElement pageBtn ".concat(i(e)),children:e+1},"page-"+(e+1))}))});return o},y=n(44),N=n.n(y),w=n(48);n(57);var C=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,a,c,r,o,s=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:2,console.log("\ud83d\udce1 SimpleFetch \u958b\u59cb\u6293\u53d6:",t),a=Array.isArray(t)?t:[t],c=function(){var e=Object(u.a)(d.a.mark((function e(t){var a,r,o=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:1,e.prev=1,console.log("\ud83d\udce5 \u5617\u8a66\u7b2c ".concat(a," \u6b21\u6293\u53d6: ").concat(t)),e.next=5,fetch(t,{method:"GET",mode:"cors",headers:{Accept:"application/json"}});case 5:if(r=e.sent,console.log("\ud83d\udce5 \u6536\u5230\u56de\u61c9 ".concat(t,":"),r.status,r.statusText),r.ok){e.next=9;break}throw new Error("HTTP error! status: ".concat(r.status));case 9:return e.abrupt("return",r.json());case 12:if(e.prev=12,e.t0=e.catch(1),console.log("\u274c \u7b2c ".concat(a," \u6b21\u5617\u8a66\u5931\u6557:"),e.t0.message),!(a<=n)){e.next=20;break}return console.log("\ud83d\udd04 \u7b49\u5f85 2 \u79d2\u5f8c\u91cd\u8a66..."),e.next=19,new Promise((function(e){return setTimeout(e,2e3)}));case 19:return e.abrupt("return",c(t,a+1));case 20:throw e.t0;case 21:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),r=a.map((function(e){return c(e)})),e.prev=5,e.next=8,Promise.all(r);case 8:return o=e.sent,console.log("\u2705 SimpleFetch \u6210\u529f:",o),e.abrupt("return",o.flat());case 13:return e.prev=13,e.t0=e.catch(5),console.error("\u274c SimpleFetch \u6700\u7d42\u5931\u6557:",e.t0),e.abrupt("return",[]);case 17:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(u.a)(d.a.mark((function e(t){var n,a,c,r,o,s,i,l,u,m;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\ud83c\udfd9\ufe0f \u53f0\u5317\u5e02\u5c08\u7528 Fetcher \u958b\u59cb:",t),e.prev=1,e.next=4,fetch(t,{method:"GET",mode:"cors"});case 4:if((n=e.sent).ok){e.next=7;break}throw new Error("HTTP error! status: ".concat(n.status));case 7:return e.next=9,n.json();case 9:return a=e.sent,console.log("\u2705 \u53f0\u5317\u5e02\u8cc7\u6599\u8f09\u5165\u6210\u529f"),e.abrupt("return",a);case 14:e.prev=14,e.t0=e.catch(1),console.log("\u274c \u53f0\u5317\u5e02\u76f4\u63a5\u6293\u53d6\u5931\u6557\uff0c\u5617\u8a66\u5099\u7528\u65b9\u6848:",e.t0.message),c=0,r=["https://api.allorigins.win/get?url=","https://corsproxy.io/?","https://cors-anywhere.herokuapp.com/"];case 19:if(!(c<r.length)){e.next=59;break}if(o=r[c],e.prev=21,console.log("\ud83d\udd04 \u5617\u8a66\u4ee3\u7406: ".concat(o)),s=void 0,i=void 0,!o.includes("allorigins")){e.next=40;break}return s=o+encodeURIComponent(t),e.next=29,fetch(s);case 29:if(!(i=e.sent).ok){e.next=38;break}return e.next=33,i.json();case 33:if(!(l=e.sent).contents){e.next=38;break}return u=JSON.parse(l.contents),console.log("\u2705 \u53f0\u5317\u5e02\u5099\u7528\u65b9\u6848\u6210\u529f (allorigins)"),e.abrupt("return",u);case 38:e.next=50;break;case 40:return s=o+encodeURIComponent(t),e.next=43,fetch(s);case 43:if(!(i=e.sent).ok){e.next=50;break}return e.next=47,i.json();case 47:return m=e.sent,console.log("\u2705 \u53f0\u5317\u5e02\u5099\u7528\u65b9\u6848\u6210\u529f"),e.abrupt("return",m);case 50:e.next=56;break;case 52:return e.prev=52,e.t1=e.catch(21),console.log("\u274c \u4ee3\u7406\u5931\u6557: ".concat(o),e.t1.message),e.abrupt("continue",56);case 56:c++,e.next=19;break;case 59:return console.log("\u274c \u6240\u6709\u53f0\u5317\u5e02\u6293\u53d6\u65b9\u6848\u90fd\u5931\u6557"),e.abrupt("return",[]);case 61:case"end":return e.stop()}}),e,null,[[1,14],[21,52]])})));return function(t){return e.apply(this,arguments)}}(),M=Object.freeze({applicationId:"\u7533\u8acb\u66f8\u7de8\u865f",permitId:"\u8a31\u53ef\u8b49\u7de8\u865f",startDate:"\u6838\u51c6\u8d77\u65e5\u671f",endDate:"\u6838\u51c6\u8fc4\u65e5\u671f",applicantUnit:"\u7533\u8acb\u55ae\u4f4d",projectName:"\u5de5\u7a0b\u540d\u7a31",caseType:"\u6848\u4ef6\u985e\u5225",pipeType:"\u7ba1\u7dda\u5de5\u7a0b\u985e\u5225",district:"\u5340\u57df\u540d\u7a31",location:"\u5730\u9ede",isStarted:"\u662f\u5426\u958b\u5de5",contactName:"\u627f\u8fa6\u4eba",contactPhone:"\u627f\u8fa6\u4eba\u96fb\u8a71",contractorName:"\u5ee0\u5546\u540d\u7a31",contractorPhone:"\u5ee0\u5546\u96fb\u8a71",lng:"\u7d93\u5ea6",lat:"\u7def\u5ea6",geometry:"\u65bd\u5de5\u7bc4\u570d\u5750\u6a19"}),P=Object.freeze({projectPurpose:"NPurp",projectName:"NPurp",startDate:"Cb_Da",endDate:"Ce_Da",district:"C_Name",location:"Addr",contractorName:"App_Name",contractorCompany:"Tc_Na",x:"X",y:"Y"}),A=Object.freeze({projectName:"cnstRoad",dateRange:"cnstDate",contractorName:"contractor",contractorPhone:"contractorPhone",permitId:"pmtNo",lat:"lat",lng:"lng"}),I=n(36);I.a.defs("TWD97","+proj=tmerc +lat_0=0 +lon_0=121 +k=0.9999 +x_0=250000 +y_0=0 +ellps=GRS80 +units=m +no_defs"),I.a.defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees");var T={taichung:{name:"\u53f0\u4e2d\u5e02",center:{lat:24.1512535,lng:120.6617366},apiUrl:"https://datacenter.taichung.gov.tw/swagger/OpenData/d5adb71a-00bb-4573-b67e-ffdccfc7cd27",keyMap:M,fetcher:S,parser:function(e){console.log("\ud83c\udfd9\ufe0f \u53f0\u4e2d\u5e02\u89e3\u6790\u55ae\u500b\u9805\u76ee:",e);var t=function(e){if(!e)return null;if(!/^POLYGON\(\(.*\)\)$/.test(e.replace(/\s/g,"")))return null;try{return e.replace(/\s/g,"").split("POLYGON((")[1].split("))")[0].split(",").map((function(e){var t=e.split("24."),n=Object(m.a)(t,2),a=n[0],c=n[1];return{lat:Number("24."+c),lng:Number(a)}}))}catch(t){return console.log("\u274c \u53f0\u4e2d\u5e02\u591a\u908a\u5f62\u89e3\u6790\u932f\u8aa4:",t),null}},n=function(e){return console.log("\ud83d\udcc5 \u53f0\u4e2d\u5e02\u89e3\u6790\u65e5\u671f:",e),e&&7===e.length?{year:Number(e.substring(0,3))+1911,month:Number(e.substring(3,5)),day:Number(e.substring(5))}:{year:2025,month:7,day:2}},a=e[M.lng],c=e[M.lat],r=Number(a),o=Number(c);if(console.log("\ud83d\uddfa\ufe0f \u53f0\u4e2d\u5e02\u539f\u59cb\u5ea7\u6a19 (WGS84):",{lat:o,lng:r,lngStr:a,latStr:c}),!a||!c||""===a||""===c||!isFinite(r)||!isFinite(o)){console.log("\u274c \u53f0\u4e2d\u5e02\u5ea7\u6a19\u8cc7\u6599\u70ba\u7a7a\uff0c\u4f7f\u7528\u9810\u8a2d\u5ea7\u6a19:",{lngStr:a,latStr:c});var s={city:"\u53f0\u4e2d\u5e02",title:e[M.projectName]||"\u9053\u8def\u5de5\u7a0b",distriction:e[M.district]||"\u672a\u77e5\u5340\u57df",address:e[M.location]||"\u672a\u77e5\u5730\u5740",pipeType:e[M.pipeType]||"\u9053\u8def\u65bd\u5de5",constructionType:e[M.caseType]||"\u9053\u8def\u5de5\u7a0b",workingState:e[M.isStarted]||"\u672a\u77e5",date:{start:n(e[M.startDate]),end:n(e[M.endDate])},applicationNumber:e[M.applicationId]||"N/A",licenseNumber:e[M.permitId]||"N/A",applicant:e[M.applicantUnit]||"N/A",contractor:{name:e[M.contractorName]||"N/A",phone:e[M.contractorPhone]||"N/A"},personInCharge:{name:e[M.contactName]?e[M.contactName].substring(0,1)+"\u25ef\u25ef":"N/A",phone:e[M.contactPhone]||"N/A"},coordinate:{lat:24.163+.1*(Math.random()-.5),lng:120.673+.1*(Math.random()-.5),polygon:t(e[M.geometry])}};return console.log("\ud83d\udd27 \u53f0\u4e2d\u5e02\u4f7f\u7528\u9810\u8a2d\u5ea7\u6a19\u7684\u89e3\u6790\u7d50\u679c:",s),s}if(r<120||r>122||o<23||o>25)return console.log("\u26a0\ufe0f \u53f0\u4e2d\u5e02\u5ea7\u6a19\u8d85\u51fa\u7bc4\u570d\uff0c\u4f7f\u7528\u9810\u8a2d\u5ea7\u6a19:",{lng:r,lat:o}),{city:"\u53f0\u4e2d\u5e02",title:e[M.projectName]||"\u9053\u8def\u5de5\u7a0b",distriction:e[M.district]||"\u672a\u77e5\u5340\u57df",address:e[M.location]||"\u672a\u77e5\u5730\u5740",pipeType:e[M.pipeType]||"\u9053\u8def\u65bd\u5de5",constructionType:e[M.caseType]||"\u9053\u8def\u5de5\u7a0b",workingState:e[M.isStarted]||"\u672a\u77e5",date:{start:n(e[M.startDate]),end:n(e[M.endDate])},applicationNumber:e[M.applicationId]||"N/A",licenseNumber:e[M.permitId]||"N/A",applicant:e[M.applicantUnit]||"N/A",contractor:{name:e[M.contractorName]||"N/A",phone:e[M.contractorPhone]||"N/A"},personInCharge:{name:e[M.contactName]?e[M.contactName].substring(0,1)+"\u25ef\u25ef":"N/A",phone:e[M.contactPhone]||"N/A"},coordinate:{lat:24.163+.1*(Math.random()-.5),lng:120.673+.1*(Math.random()-.5),polygon:t(e[M.geometry])}};console.log("\u2705 \u53f0\u4e2d\u5e02\u6709\u6548\u5ea7\u6a19 (WGS84):",{lat:o,lng:r});var i={city:"\u53f0\u4e2d\u5e02",title:e[M.projectName]||"\u9053\u8def\u5de5\u7a0b",distriction:e[M.district]||"\u672a\u77e5\u5340\u57df",address:e[M.location]||"\u672a\u77e5\u5730\u5740",pipeType:e[M.pipeType]||"\u9053\u8def\u65bd\u5de5",constructionType:e[M.caseType]||"\u9053\u8def\u5de5\u7a0b",workingState:e[M.isStarted]||"\u672a\u77e5",date:{start:n(e[M.startDate]),end:n(e[M.endDate])},applicationNumber:e[M.applicationId]||"N/A",licenseNumber:e[M.permitId]||"N/A",applicant:e[M.applicantUnit]||"N/A",contractor:{name:e[M.contractorName]||"N/A",phone:e[M.contractorPhone]||"N/A"},personInCharge:{name:e[M.contactName]?e[M.contactName].substring(0,1)+"\u25ef\u25ef":"N/A",phone:e[M.contactPhone]||"N/A"},coordinate:{lat:o,lng:r,polygon:t(e[M.geometry])}};return console.log("\u2728 \u53f0\u4e2d\u5e02\u89e3\u6790\u7d50\u679c:",i),i},isDisabled:!1},taipei:{name:"\u53f0\u5317\u5e02",center:{lat:25.033,lng:121.5654},apiUrl:"https://tpnco.blob.core.windows.net/blobfs/Todaywork.json",keyMap:P,fetcher:S,parser:function(e){console.log("\ud83c\udfd9\ufe0f \u53f0\u5317\u5e02\u89e3\u6790\u55ae\u500b\u9805\u76ee:",e);var t=e.properties,n=e.geometry;console.log("\ud83d\udccb Properties:",t),console.log("\ud83d\udccd Geometry:",n);var a=function(e){return console.log("\ud83d\udcc5 \u89e3\u6790\u65e5\u671f:",e),e&&9===e.length?{year:parseInt(e.substring(0,3),10)+1911,month:parseInt(e.substring(4,6),10),day:parseInt(e.substring(7,9),10)}:{year:2025,month:7,day:2}},c=a(t[P.startDate]),r=a(t[P.endDate]),o=parseFloat(n.coordinates[0]),s=parseFloat(n.coordinates[1]);console.log("\ud83d\uddfa\ufe0f \u539f\u59cb\u5750\u6a19 (TWD97):",{x:o,y:s});var i=function(e,t){if("number"!==typeof e||"number"!==typeof t)return console.error("Invalid coordinates for conversion"),{lat:0,lng:0};var n=Object(I.a)("TWD97","WGS84",[e,t]),a=Object(m.a)(n,2),c=a[0];return{lat:a[1],lng:c}}(o,s),l=i.lat,d=i.lng;console.log("\ud83c\udf0d \u8f49\u63db\u5f8c\u5750\u6a19 (WGS84):",{lat:l,lng:d});var u={city:"\u53f0\u5317\u5e02",title:t[P.projectName]||t[P.projectPurpose]||"\u9053\u8def\u5de5\u7a0b",distriction:t[P.district]||"\u672a\u77e5\u5340\u57df",address:t[P.location]||"\u672a\u77e5\u5730\u5740",pipeType:"\u9053\u8def\u65bd\u5de5",constructionType:t[P.projectPurpose]||"\u9053\u8def\u5de5\u7a0b",workingState:"\u662f",date:{start:c,end:r},applicationNumber:"N/A",licenseNumber:"N/A",applicant:t[P.contractorName]||"N/A",contractor:{name:t[P.contractorCompany]||t[P.contractorName]||"N/A",phone:"N/A"},personInCharge:{name:"N/A",phone:"N/A"},coordinate:{lat:l,lng:d,polygon:null}};return console.log("\u2728 \u53f0\u5317\u5e02\u89e3\u6790\u7d50\u679c:",u),u},isDisabled:!1},kaohsiung:{name:"\u9ad8\u96c4\u5e02",center:{lat:22.6273,lng:120.3014},apiUrl:"https://corsproxy.io/?https://data.kcg.gov.tw/Json/Get/d636aa85-4b08-42ab-a742-4f2aad070450",keyMap:A,fetcher:C,parser:function(e){return console.log("\ud83c\udfed \u9ad8\u96c4\u5e02\u89e3\u6790\u539f\u59cb\u8cc7\u6599:",e),e&&e.Data&&Array.isArray(e.Data)?(console.log("\ud83d\udcca \u9ad8\u96c4\u5e02 Data \u9663\u5217\u9577\u5ea6:",e.Data.length),e.Data.map((function(e,t){console.log("\ud83d\udd04 \u8655\u7406\u9ad8\u96c4\u5e02\u7b2c ".concat(t+1," \u7b46\u8cc7\u6599:"),e);var n=function(e){if(console.log("\ud83d\udcc5 \u9ad8\u96c4\u5e02\u89e3\u6790\u65e5\u671f:",e),!e)return{year:2025,month:7,day:2};var t=new Date(e);return{year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()}}(e[A.dateRange]),a={city:"\u9ad8\u96c4\u5e02",title:e[A.projectName]||"\u672a\u77e5\u5de5\u7a0b",distriction:"N/A",address:e[A.projectName]||"\u672a\u77e5\u5730\u5740",pipeType:"\u9053\u8def\u65bd\u5de5",constructionType:"\u9053\u8def\u5de5\u7a0b",workingState:"\u662f",date:{start:n,end:n},applicationNumber:"N/A",licenseNumber:e[A.permitId]||"N/A",applicant:e[A.contractorName]||"N/A",contractor:{name:e[A.contractorName]||"N/A",phone:e[A.contractorPhone]||"N/A"},personInCharge:{name:"N/A",phone:"N/A"},coordinate:{lat:Number(e[A.lat])||0,lng:Number(e[A.lng])||0,polygon:null}};return console.log("\u2728 \u9ad8\u96c4\u5e02\u7b2c ".concat(t+1," \u7b46\u89e3\u6790\u7d50\u679c:"),a),a}))):(console.log("\u274c \u9ad8\u96c4\u5e02\u8cc7\u6599\u683c\u5f0f\u932f\u8aa4"),[])},isDisabled:!0}},D=function(e){var t=Object(a.useState)([null,null]),n=Object(m.a)(t,2),c=n[0],r=n[1],o=Object(m.a)(c,2),s=o[0],l=o[1],d=Object(a.useState)(""),u=Object(m.a)(d,2),p=u[0],j=u[1],h=Object(a.useState)({dist:null,workingState:null}),b=Object(m.a)(h,2),f=b[0],v=b[1],O=e.options,x=e.condition,k=e.mapParameters,C=e.setCondition,S=e.setPageIndex,M=e.setMapParameters,P=Object(a.useCallback)((function(){var e=document.getElementById("districtionSelect");A(e),A(e.previousElementSibling,e.value),Object(y.registerLocale)("zh-TW",w.a)}),[]);Object(a.useEffect)((function(){P(),v({dist:B("districtionSelect"),workingState:B("workingStateSelect")})}),[P]);var A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.value;e.dataset.chosen=t},I=function(e){var t="number"===typeof e?e.toString():e;return 1===t.length&&(t="0"+t),t},D=function(){var e=B("districtionSelect");console.log("\ud83c\udfaf \u76ee\u524d\u9078\u64c7\u7684\u5730\u5340:",e);var t=k.center,n=!1;e&&"\u5168\u5340\u57df"!==e&&"\u8f09\u5165\u4e2d"!==e&&"\u5168\u5730\u5340"!==e&&(["\u4e2d\u6b63\u5340","\u5927\u540c\u5340","\u4e2d\u5c71\u5340","\u677e\u5c71\u5340","\u5927\u5b89\u5340","\u842c\u83ef\u5340","\u4fe1\u7fa9\u5340","\u58eb\u6797\u5340","\u5317\u6295\u5340","\u5167\u6e56\u5340","\u5357\u6e2f\u5340","\u6587\u5c71\u5340"].includes(e)?(t=T.taipei.center,n=!0,console.log("\ud83c\udfd9\ufe0f \u5207\u63db\u5230\u53f0\u5317\u5e02\u4e2d\u5fc3")):["\u4e2d\u5340","\u6771\u5340","\u5357\u5340","\u897f\u5340","\u5317\u5340","\u5317\u5c6f\u5340","\u897f\u5c6f\u5340","\u5357\u5c6f\u5340","\u592a\u5e73\u5340","\u5927\u91cc\u5340","\u9727\u5cf0\u5340","\u70cf\u65e5\u5340","\u8c50\u539f\u5340","\u540e\u91cc\u5340","\u77f3\u5ca1\u5340","\u6771\u52e2\u5340","\u548c\u5e73\u5340","\u65b0\u793e\u5340","\u6f6d\u5b50\u5340","\u5927\u96c5\u5340","\u795e\u5ca1\u5340","\u5927\u809a\u5340","\u6c99\u9e7f\u5340","\u9f8d\u4e95\u5340","\u68a7\u68f2\u5340","\u6e05\u6c34\u5340","\u5927\u7532\u5340","\u5916\u57d4\u5340","\u5927\u5b89\u5340"].includes(e)?(t=T.taichung.center,n=!0,console.log("\ud83c\udfd8\ufe0f \u5207\u63db\u5230\u53f0\u4e2d\u5e02\u4e2d\u5fc3")):["\u65b0\u8208\u5340","\u524d\u91d1\u5340","\u82d3\u96c5\u5340","\u9e7d\u57d5\u5340","\u9f13\u5c71\u5340","\u65d7\u6d25\u5340","\u524d\u93ae\u5340","\u4e09\u6c11\u5340","\u6960\u6893\u5340","\u5c0f\u6e2f\u5340","\u5de6\u71df\u5340","\u4ec1\u6b66\u5340","\u5927\u793e\u5340","\u5ca1\u5c71\u5340","\u8def\u7af9\u5340","\u963f\u84ee\u5340","\u7530\u5bee\u5340","\u71d5\u5de2\u5340","\u6a4b\u982d\u5340","\u6893\u5b98\u5340","\u5f4c\u9640\u5340","\u6c38\u5b89\u5340","\u6e56\u5167\u5340","\u9cf3\u5c71\u5340","\u5927\u5bee\u5340","\u6797\u5712\u5340","\u9ce5\u677e\u5340","\u5927\u6a39\u5340","\u65d7\u5c71\u5340","\u7f8e\u6fc3\u5340","\u516d\u9f9c\u5340","\u5167\u9580\u5340","\u6749\u6797\u5340","\u7532\u4ed9\u5340","\u6843\u6e90\u5340","\u90a3\u746a\u590f\u5340","\u8302\u6797\u5340","\u8304\u8423\u5340"].includes(e)&&(t=T.kaohsiung.center,n=!0,console.log("\ud83c\udfed \u5207\u63db\u5230\u9ad8\u96c4\u5e02\u4e2d\u5fc3"))),M({center:t,polygon:null,zoom:n?12:k.zoom,selectMarker:k.selectMarker,closeInfoWindow:!0})},B=function(e){var t=document.getElementById(e),n=null;if(null===t)n="\u8f09\u5165\u4e2d";else{if(n=t.value,"workingStateSelect"===e)switch(n){case"0":n="\u5168\u6848\u4ef6";break;case"\u662f":n="\u65bd\u5de5\u4e2d";break;case"\u5426":n="\u672a\u65bd\u5de5"}"districtionSelect"===e&&"0"===n&&(n="\u5168\u5730\u5340")}return n},_=function(e){var t=null;switch(e){case 0:t="\u5168\u6848\u4ef6";break;case"\u662f":t="\u65bd\u5de5\u4e2d";break;case"\u5426":t="\u672a\u65bd\u5de5"}return t},E=Array.from({length:O.workingState.length},(function(e,t){return t})),z=Array.from({length:O.distriction.length},(function(e,t){return t}));return Object(g.jsxs)("div",{className:"selectors",children:[Object(g.jsxs)("div",{className:"selectContainer",children:[Object(g.jsx)("i",{className:"selectArrow fas fa-chevron-down"}),Object(g.jsxs)("select",{name:"workingState",id:"workingStateSelect",defaultValue:"\u662f",onChange:function(e){var t=x.distriction,n=0===Number(e.target.value)?0:e.target.value,a=null===x.date.start?null:Object(i.a)({},x.date.start),c=null===x.date.end?null:Object(i.a)({},x.date.end),r=p,o=x.stack;A(e.target),A(e.target.previousElementSibling,e.target.value),v((function(e){return Object(i.a)(Object(i.a)({},e),{},{workingState:_(n)})})),-1===o.indexOf("workingState")?o.push("workingState"):0===n&&(o=o.filter((function(e){return"workingState"!==e}))),D(),S(0),j(""!==r?"".concat(a.year,"/").concat(I(a.month),"/").concat(I(a.day)," - ").concat(c.year,"/").concat(I(c.month),"/").concat(I(c.day)):""),C({workingState:n,distriction:t,date:{start:null===a?null:Object(i.a)({},a),end:null===c?null:Object(i.a)({},c)},stack:o})},children:[Object(g.jsx)("option",{value:0,children:"\u5168\u6848\u4ef6"}),E.map((function(e){return Object(g.jsx)("option",{value:O.workingState[e],children:"\u662f"===O.workingState[e]?"\u65bd\u5de5\u4e2d":"\u672a\u65bd\u5de5"},O.workingState[e])}))]}),Object(g.jsx)("span",{children:f.workingState})]}),Object(g.jsxs)("div",{className:"selectContainer",children:[Object(g.jsx)("i",{className:"selectArrow fas fa-chevron-down"}),Object(g.jsxs)("select",{name:"distriction",id:"districtionSelect",defaultValue:"0",onChange:function(e){var t=0===Number(e.target.value)?0:e.target.value,n=x.workingState,a=null===x.date.start?null:Object(i.a)({},x.date.start),c=null===x.date.end?null:Object(i.a)({},x.date.end),r=p,o=x.stack;A(e.target),A(e.target.previousElementSibling,e.target.value),v((function(e){return Object(i.a)(Object(i.a)({},e),{},{dist:0===t?"\u5168\u5730\u5340":t})})),-1===o.indexOf("distriction")?o.push("distriction"):0===t&&(o=o.filter((function(e){return"distriction"!==e}))),D(),S(0),j(""!==r?"".concat(a.year,"/").concat(I(a.month),"/").concat(I(a.day)," - ").concat(c.year,"/").concat(I(c.month),"/").concat(I(c.day)):""),C({workingState:n,distriction:t,date:{start:null===a?null:Object(i.a)({},a),end:null===c?null:Object(i.a)({},c)},stack:o})},children:[Object(g.jsx)("option",{value:0,children:"\u5168\u5730\u5340"}),z.map((function(e){return Object(g.jsx)("option",{value:O.distriction[e],children:O.distriction[e]},O.distriction[e])}))]}),Object(g.jsx)("span",{children:f.dist})]}),Object(g.jsx)(N.a,{value:p,locale:"zh-TW",wrapperClassName:"dateSelectContainer",className:"dateSelect",placeholderText:"\u65e5\u671f\u7bc4\u570d",dateFormat:"yyyy/MM/dd",selectsRange:!0,startDate:s,endDate:l,minDate:new Date(Object.values(O.date.start)),maxDate:new Date(Object.values(O.date.end)),isClearable:!0,shouldCloseOnSelect:!1,onChange:function(e){if(r(e),null===e[0]||null!==e[1]){if(null===e[0]&&null===e[1]){var t=x.stack,n=x.distriction,a=x.workingState;return t=t.filter((function(e){return"date"!==e})),D(),j(""),void C({workingState:a,distriction:n,date:{start:null,end:null},stack:t})}var c=x.distriction,o=x.workingState,s={year:e[0].getFullYear(),month:e[0].getMonth()+1,day:e[0].getDate()},l={year:e[1].getFullYear(),month:e[1].getMonth()+1,day:e[1].getDate()},d=x.stack;-1===d.indexOf("date")&&d.push("date"),D(),S(0),j("".concat(s.year,"/").concat(I(s.month),"/").concat(I(s.day)," - ").concat(l.year,"/").concat(I(l.month),"/").concat(I(l.day))),C({workingState:o,distriction:c,date:{start:Object(i.a)({},s),end:Object(i.a)({},l)},stack:d})}else j("".concat(e[0].getFullYear(),"/").concat(I(e[0].getMonth()+1),"/").concat(I(e[0].getDate())," -"))},onFocus:function(e){return e.target.blur()}})]})},B=function(e){var t=e.closeInfoBlock,n=e.handleCloseClick,c=e.isMobile,r=Object(a.useState)(0),o=Object(m.a)(r,2),s=o[0],i=o[1],l=Object(a.useState)(10),d=Object(m.a)(l,2),u=d[0],p=d[1];Object(a.useEffect)((function(){if("loading"===e.value&&e.isLoading){p(10);var t=setInterval((function(){p((function(e){return e<=1?(clearInterval(t),0):e-1}))}),1e3);return function(){return clearInterval(t)}}}),[e.value,e.isLoading]);var j=Object(a.useMemo)((function(){var t=0;if(null!==e.value)return t=e.value.length>1?e.value[s].length:1===e.value.length?e.value[0].length:0,Array.from({length:t},(function(e,t){return t}))}),[e.value,s]),h=function(t){t>e.value.length-1||t<0||(document.getElementById("topAnchor").scrollIntoView(!1),i(t))},b=function(e){var t="";return null===e?t="hide":!0===e?t="close":!1===e&&(t="open"),t};if("loading"===e.value&&e.isLoading)return Object(g.jsx)("div",{className:"infoBlockContainer",children:Object(g.jsx)("div",{className:"infoBlock",style:{paddingTop:"0",backgroundColor:"#ececec"},children:Object(g.jsxs)("div",{className:"loading",children:[Object(g.jsx)("i",{className:"fas fa-circle-notch fa-lg",style:{animation:"spin 2s linear infinite",color:"#3498db"}}),Object(g.jsxs)("div",{style:{marginTop:"15px",textAlign:"center"},children:[Object(g.jsx)("p",{style:{margin:"0 0 8px 0",color:"#555",fontSize:"16px",fontWeight:"500"},children:"\u8f09\u5165\u8cc7\u6599\u4e2d\uff0c\u60a8\u53ef\u4ee5\u5148\u79fb\u52d5\u5730\u5716..."}),Object(g.jsx)("div",{style:{fontSize:"14px",color:"#888",background:"linear-gradient(90deg, #3498db 0%, #2ecc71 50%, #3498db 100%)",backgroundSize:"200% auto",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontWeight:"bold",animation:"textShimmer 2s ease-in-out infinite"},children:u>0?"\u9810\u8a08\u9084\u9700 ".concat(u," \u79d2"):"\u5373\u5c07\u5b8c\u6210..."}),Object(g.jsx)("div",{style:{width:"80%",height:"4px",backgroundColor:"#ddd",borderRadius:"2px",margin:"10px auto",overflow:"hidden"},children:Object(g.jsx)("div",{style:{height:"100%",backgroundColor:"#3498db",borderRadius:"2px",width:"".concat((10-u)/10*100,"%"),transition:"width 1s ease-in-out",background:"linear-gradient(90deg, #3498db, #2ecc71)",animation:"progressGlow 2s ease-in-out infinite"}})})]})]})})});if(null===e.value)return Object(g.jsx)("div",{className:"infoBlockContainer",children:Object(g.jsx)("div",{className:"infoBlock",children:Object(g.jsxs)("div",{className:"noContent",children:[Object(g.jsx)("div",{className:"exclamationMark",children:Object(g.jsx)("i",{className:"fas fa-exclamation-triangle fa-lg"})}),Object(g.jsx)("div",{children:"\u767c\u751f\u932f\u8aa4\uff0c\u8acb\u7a0d\u5f8c\u5728\u8a66"})]})})});if(0===e.length)return Object(g.jsx)("div",{className:"infoBlockContainer ".concat(b(t)),children:Object(g.jsxs)("div",{className:"infoBlock",children:[Object(g.jsx)(x,{handleCloseClick:n}),Object(g.jsx)("div",{className:"toolbarContainer",children:Object(g.jsx)(D,{options:e.option,condition:e.condition,mapParameters:e.mapParameters,setCondition:e.setCondition,setMapParameters:e.setMapParameters,setPageIndex:i,constructionsData:e.constructionsData})}),Object(g.jsx)("div",{className:"cardsListContainer",children:Object(g.jsx)("div",{className:"cardsList",children:Object(g.jsx)("div",{className:"noContent",children:"\u6c92\u6709\u7b26\u5408\u689d\u4ef6\u7684\u8cc7\u6599"})})})]})});var f=Array.from({length:e.value.length},(function(e,t){return t}));return Object(g.jsx)("div",{className:"infoBlockContainer ".concat(b(t)),children:Object(g.jsxs)("div",{className:"infoBlock",children:[Object(g.jsx)(x,{handleCloseClick:n}),Object(g.jsx)("div",{className:"toolbarContainer",children:Object(g.jsx)(D,{options:e.option,condition:e.condition,setCondition:e.setCondition,setPageIndex:i,mapParameters:e.mapParameters,setMapParameters:e.setMapParameters,constructionsData:e.constructionsData})}),Object(g.jsx)("div",{className:"cardsListContainer",children:Object(g.jsxs)("div",{className:"cardsList",children:[Object(g.jsx)(k,{pageBtns:f,pageIndex:s,handlePaginationClick:h,isMobile:c}),Object(g.jsx)("div",{id:"topAnchor",style:{marginBottom:"2em"}}),j.map((function(t){return Object(g.jsx)(O,{value:e.value[s][t],setMapParameters:e.setMapParameters},"card"+(10*s+t+1))})),Object(g.jsx)(k,{pageBtns:f,pageIndex:s,handlePaginationClick:h,isMobile:c})]})})]})})},_=function(e){var t=e.closeInfoBlock,n=e.makerMessage,a=e.handleCloseClick,c=e.handleMakerMessageClick,r=e.userLocation,o=e.mapParameters,s=e.setMapParameters;return Object(g.jsxs)("div",{className:"infoButtonContainer ".concat(!1!==t&&!0!==n?"open":"close"),children:[Object(g.jsx)("div",{className:"button",onClick:a,children:Object(g.jsx)("i",{className:"fas fa-search fa-lg"})}),Object(g.jsx)("div",{className:"button",onClick:function(){var e=Math.random()/1e6;s({center:{lat:r.lat+e,lng:r.lng+e},polygon:o.polygon,zoom:o.zoom,selectMarker:o.selectMarker,closeInfoWindow:!1})},style:{display:null===r?"none":""},children:Object(g.jsx)("i",{className:"fas fa-map-marker-alt fa-lg"})}),Object(g.jsx)("div",{className:"button",onClick:function(){c()},children:Object(g.jsx)("i",{className:"fas fa-info fa-lg"})})]})},E=function(e){var t=e.makerMessage,n=e.handleMakerMessageClick;return Object(g.jsx)("div",{className:"infoBlockContainer ".concat(function(e){var t="";return null===e?t="hide":!0===e?t="open":!1===e&&(t="close"),t}(t)),children:Object(g.jsxs)("div",{className:"infoBlock maker",children:[Object(g.jsx)(x,{handleMakerMessageClick:n}),Object(g.jsx)("div",{className:"makerMessage flex",children:Object(g.jsx)("div",{})})]})})},z=function(){var e=Object(a.useState)(null),t=Object(m.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(null),o=Object(m.a)(r,2),l=o[0],p=o[1],j=Object(a.useState)(null),h=Object(m.a)(j,2),b=h[0],f=h[1],O=Object(a.useState)(null),x=Object(m.a)(O,2),k=x[0],y=x[1],N=Object(a.useState)("loading"),w=Object(m.a)(N,2),C=w[0],S=w[1],M=Object(a.useState)({workingState:"\u662f",distriction:0,date:{start:null,end:null},stack:["workingState"]}),P=Object(m.a)(M,2),A=P[0],I=P[1],D=Object(a.useState)({center:{lat:25.033,lng:121.5654},polygon:null,zoom:12,selectMarker:null,closeInfoWindow:null}),z=Object(m.a)(D,2),W=z[0],L=z[1],G=Object(a.useCallback)((function(){var e;U(),e=Y(428),window.addEventListener("resize",U),window.addEventListener("resize",(function(){return Y(428)})),F(),R(e)}),[]),F=function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){!function(e){var t={center:{lat:e.coords.latitude,lng:e.coords.longitude},polygon:null,zoom:12,selectMarker:null,closeInfoWindow:null};L(t),p(t.center)}(e)})):console.log("geolocation is not available")},R=function(e){!1===e&&f(!1)},U=function(){document.documentElement.style.setProperty("--vh","".concat(window.innerHeight/100,"px"))},Y=function(e){var t=null;return t=window.innerWidth<=e,c(t),t},J=function(e){var t=Object.values(e),n=Object(m.a)(t,3),a=n[0],c=n[1],r=n[2];return a=a.toString(),c=c.toString(),r=r.toString(),1===c.length&&(c="0"+c),1===r.length&&(r="0"+r),parseInt(a+c+r,10)},H=function(e){for(var t=e,n=[],a=0;a<t.length;a+=10)n.push(t.slice(a,a+10));return n},V=Object(a.useCallback)(Object(u.a)(d.a.mark((function e(){var t,n,a,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("\ud83d\ude80 \u958b\u59cb\u6293\u53d6\u8cc7\u6599..."),S("loading"),t=Object.values(T).filter((function(e){return!e.isDisabled})),console.log("\ud83d\udccd \u555f\u7528\u7684\u57ce\u5e02:",t.map((function(e){return e.name}))),n=t.map(function(){var e=Object(u.a)(d.a.mark((function e(t){var n,a,c,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("\ud83d\udce1 \u6b63\u5728\u6293\u53d6 ".concat(t.name," \u7684\u8cc7\u6599..."),t.apiUrl),e.next=4,t.fetcher(t.apiUrl);case 4:return n=e.sent,console.log("\u2705 ".concat(t.name," \u539f\u59cb\u8cc7\u6599:"),n),"\u53f0\u5317\u5e02"===t.name?(console.log("\ud83c\udfd9\ufe0f \u53f0\u5317\u5e02 features \u6578\u91cf:",(null===n||void 0===n||null===(c=n.features)||void 0===c?void 0:c.length)||0),n&&n.features&&Array.isArray(n.features)?a=n.features.map(t.parser):(console.log("\u26a0\ufe0f \u53f0\u5317\u5e02\u8cc7\u6599\u683c\u5f0f\u7570\u5e38\uff0c\u8df3\u904e\u89e3\u6790"),a=[])):"\u9ad8\u96c4\u5e02"===t.name?(console.log("\ud83c\udfed \u9ad8\u96c4\u5e02 Data \u6578\u91cf:",(null===n||void 0===n||null===(r=n.Data)||void 0===r?void 0:r.length)||0),a=t.parser(n)):"\u53f0\u4e2d\u5e02"===t.name?(console.log("\ud83c\udfd8\ufe0f \u53f0\u4e2d\u5e02\u8cc7\u6599\u9577\u5ea6:",(null===n||void 0===n?void 0:n.length)||0),Array.isArray(n)?(a=n.map(t.parser),console.log("\u2728 \u53f0\u4e2d\u5e02\u89e3\u6790\u5f8c\u8cc7\u6599\u6578\u91cf:",a.length)):(console.log("\u26a0\ufe0f \u53f0\u4e2d\u5e02\u8cc7\u6599\u683c\u5f0f\u7570\u5e38\uff0c\u8df3\u904e\u89e3\u6790"),a=[])):(console.log("\ud83c\udfd8\ufe0f ".concat(t.name," \u8cc7\u6599\u9577\u5ea6:"),(null===n||void 0===n?void 0:n.length)||0),a=Array.isArray(n)?n.map(t.parser):[]),console.log("\u2728 ".concat(t.name," \u89e3\u6790\u5f8c\u8cc7\u6599:"),a),e.abrupt("return",a);case 11:return e.prev=11,e.t0=e.catch(0),console.error("\u274c ".concat(t.name," \u6293\u53d6\u5931\u6557:"),e.t0),e.abrupt("return",[]);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()),e.next=7,Promise.allSettled(n);case 7:a=e.sent,console.log("\ud83c\udfaf Promise.allSettled \u7d50\u679c:",a),(c=a.filter((function(e){return"fulfilled"===e.status})).flatMap((function(e){return e.value}))).sort((function(e,t){return"\u53f0\u5317\u5e02"===e.city&&"\u53f0\u5317\u5e02"!==t.city?-1:"\u53f0\u5317\u5e02"!==e.city&&"\u53f0\u5317\u5e02"===t.city?1:"\u53f0\u4e2d\u5e02"===e.city&&"\u9ad8\u96c4\u5e02"===t.city?-1:"\u9ad8\u96c4\u5e02"===e.city&&"\u53f0\u4e2d\u5e02"===t.city?1:0})),console.log("\ud83d\udcca \u5408\u4f75\u5f8c\u7684\u6240\u6709\u8cc7\u6599:",c),console.log("\ud83d\udcc8 \u7e3d\u8cc7\u6599\u7b46\u6578:",c.length),console.log("\ud83c\udfd9\ufe0f \u8cc7\u6599\u57ce\u5e02\u5206\u4f48:",c.reduce((function(e,t){return e[t.city]=(e[t.city]||0)+1,e}),{})),0===c.length?(console.log("\u26a0\ufe0f \u6c92\u6709\u8cc7\u6599\uff0c\u8a2d\u5b9a\u70ba null"),S(null)):(console.log("\ud83c\udf89 \u8a2d\u5b9a\u8cc7\u6599\u5b8c\u6210"),S(c));case 15:case"end":return e.stop()}}),e)}))),[]);Object(a.useEffect)((function(){G(),V()}),[G,V]);var Z=Object(a.useMemo)((function(){return function(e){var t=C,n=[];if(null===t||"loading"===t)n=t;else if(3===e.stack.length)n=t.filter((function(t){return(J(e.date.start)>=J(t.date.start)&&J(e.date.start)<=J(t.date.end)||J(e.date.end)>=J(t.date.start)&&J(e.date.end)<=J(t.date.end))&&t.workingState===e.workingState&&t.distriction===e.distriction}));else if(2===e.stack.length)if(-1!==e.stack.indexOf("date")){var a=e.stack[1-e.stack.indexOf("date")];n=t.filter((function(t){return(J(e.date.start)>=J(t.date.start)&&J(e.date.start)<=J(t.date.end)||J(e.date.end)>=J(t.date.start)&&J(e.date.end)<=J(t.date.end))&&t[a]===e[a]}))}else n=t.filter((function(t){return t.workingState===e.workingState&&t.distriction===e.distriction}));else 1===e.stack.length&&(0!==e.distriction?n=t.filter((function(t){return t.distriction===e.distriction})):null!==e.date.start&&null!==e.date.end?n=t.filter((function(t){return J(e.date.start)>=J(t.date.start)&&J(e.date.start)<=J(t.date.end)||J(e.date.end)>=J(t.date.start)&&J(e.date.end)<=J(t.date.end)})):0!==e.workingState&&(n=t.filter((function(t){return t.workingState===e.workingState}))));return n}(A)}),[A,C]),K=Object(a.useMemo)((function(){var e={workingState:[],distriction:[],date:{start:{},end:{}}};if(A.stack.length>=0&&"loading"!==C&&null!==C){e.date.start=Object(i.a)({},C[0].date.start),e.date.end=Object(i.a)({},C[0].date.end);var t,n=Object(s.a)(C);try{for(n.s();!(t=n.n()).done;){var a=t.value;-1===e.workingState.indexOf(a.workingState)&&e.workingState.push(a.workingState),-1===e.distriction.indexOf(a.distriction)&&e.distriction.push(a.distriction),J(a.date.start)<=J(e.date.start)&&(e.date.start=Object(i.a)({},a.date.start)),J(a.date.end)>=J(e.date.end)&&(e.date.end=Object(i.a)({},a.date.end))}}catch(c){n.e(c)}finally{n.f()}}return e}),[A.stack,C]),X=function(){var e=b;f(e=null!==e&&!e)},$=function(){var e=k;y(e=null===k||!e)};if("loading"===C)return Object(g.jsxs)("div",{className:"container",children:[Object(g.jsx)(v,{constructionsData:null,mapParameters:W,setMapParameters:L,closeInfoBlock:b,makerMessage:k,isMobile:n,userLocation:l}),Object(g.jsx)(_,{closeInfoBlock:b,makerMessage:k,handleCloseClick:X,handleMakerMessageClick:$,userLocation:l,mapParameters:W,setMapParameters:L}),Object(g.jsx)(B,{value:"loading",length:0,option:K,condition:A,mapParameters:W,closeInfoBlock:b,isMobile:n,handleCloseClick:X,setCondition:I,setMapParameters:L,isLoading:!0,constructionsData:null}),Object(g.jsx)(E,{makerMessage:k,handleMakerMessageClick:$})]});if(null===C)return Object(g.jsxs)("div",{className:"container",children:[Object(g.jsx)(v,{constructionsData:null,mapParameters:W,setMapParameters:L,closeInfoBlock:b,makerMessage:k,isMobile:n,userLocation:l}),Object(g.jsx)(_,{closeInfoBlock:b,makerMessage:k,handleCloseClick:X,handleMakerMessageClick:$,userLocation:l,mapParameters:W,setMapParameters:L}),Object(g.jsx)(B,{value:null,length:0,option:K,condition:A,mapParameters:W,closeInfoBlock:b,isMobile:n,handleCloseClick:X,setCondition:I,setMapParameters:L,isLoading:!1,constructionsData:null}),Object(g.jsx)(E,{makerMessage:k,handleMakerMessageClick:$})]});var q=null;return q=0===A.distriction&&null===A.date.start&&null===A.date.end&&0===A.workingState?C:Z,Object(g.jsxs)("div",{className:"container",children:[Object(g.jsx)(v,{constructionsData:H(q),mapParameters:W,closeInfoBlock:b,setMapParameters:L,makerMessage:k,isMobile:n,userLocation:l}),Object(g.jsx)(_,{closeInfoBlock:b,makerMessage:k,handleCloseClick:X,handleMakerMessageClick:$,userLocation:l,mapParameters:W,setMapParameters:L}),Object(g.jsx)(B,{value:H(q),length:q.length,option:K,condition:A,mapParameters:W,closeInfoBlock:b,isMobile:n,handleCloseClick:X,setCondition:I,setMapParameters:L,constructionsData:C}),Object(g.jsx)(E,{makerMessage:k,handleMakerMessageClick:$})]})};n(105);o.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(z,{})}),document.getElementById("root"))}},[[107,1,2]]]);
//# sourceMappingURL=main.0e107bc6.chunk.js.map